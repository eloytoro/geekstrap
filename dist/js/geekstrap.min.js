angular.module("fg.geekstrap",["ngAnimate"]),angular.module("fg.geekstrap").directive("sidebar",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"geekstrap/directives/sidebar/sidebar.html",scope:{icon:"@","default":"=",persist:"="},controller:["$scope",function(e){this.items=[],e.offset={},this.setActive=function(t){if(e.persist)for(var n in this.items)this.items[n].active=n==t,this.items[n].$digest()},this.addItem=function(t){var n=this.items.length;return this.items.push(t),t.active=n==e.default,n}}],link:function(e,t){t.children().eq(0).on("mouseenter",function(){e.show||(e.peek=!0,e.offset.left="-250px",e.$digest())}),t.children().eq(1).on("mouseenter",function(){e.show=!0,e.offset.left="0px",e.$digest()}),t.on("mouseleave",function(){e.peek=!1,e.show=!1,e.offset.left="-305px",e.$digest()})}}}).directive("sidebarItem",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{icon:"@"},templateUrl:"geekstrap/directives/sidebar/sidebar-item.html",require:"^sidebar",link:function(e,t,n,i){e.index=i.addItem(e),t.on("click",function(){e.active?e.active=!1:i.setActive(e.index)})}}}),angular.module("fg.geekstrap").directive("progressButton",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"geekstrap/directives/progress-button/progress-button.html",scope:{model:"=",onload:"&"},controller:["$scope","$interval","$timeout",function(e,t,n){var i=this;e.isLoading=!1,e.isFinishing=!1,e.loadingBar={width:"0px"},this.stopProgress=function(){n(function(){e.model=-1},300),e.onload()},e.$watch("model",function(t){e.isLoading=t>=0,e.loadingBar.width=t+"%",t>=100&&i.stopProgress()})}],link:function(){}}}),angular.module("fg.geekstrap").directive("navbar",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"geekstrap/directives/navbar/navbar.html",scope:{"default":"@",alias:"=?"},controller:["$scope","$window",function(e,t){this.tabs=[];var n=this;e.caretOffset={},e.activeTab=0,this.moveCaret=function(t){for(var n=0,i=0;t>i;i++)n+=this.tabs[i].width;e.caretOffset.left=n+"px",e.caretOffset.width=this.tabs[t].width+"px"},this.setActive=function(t){for(var n in this.tabs)this.tabs[n].active=t==n,this.tabs[n].$apply();e.activeTab=t,this.moveCaret(t),e.$apply()},this.addTab=function(e){var t=this.tabs.length;return this.tabs[t]=e,t},angular.element(t).bind("resize",function(){for(var t in n.tabs)n.tabs[t].refresh();n.moveCaret(e.activeTab),e.$apply()}),this.exports={setActive:this.setActive}}],link:function(e,t,n,i){for(var s=0;s<i.tabs.length;s++)if(i.tabs[s].link==e.default){i.tabs[s].active=!0,e.activeTab=s,i.moveCaret(s);break}e.alias&&(e.alias=i.exports)}}}).directive("navbarTab",function(){return{restrict:"E",require:"^navbar",replace:!0,transclude:!0,templateUrl:"geekstrap/directives/navbar/navbar-tab.html",scope:{link:"@",activable:"=?"},link:function(e,t,n,i){e.width=t[0].offsetWidth,e.id=i.addTab(e),e.activable&&t.on("click",function(){i.setActive(e.id)}),e.refresh=function(){e.width=t[0].offsetWidth}}}}),angular.module("fg.geekstrap").directive("circularScroller",["$compile","$animate",function(e){var t=function(t){this.element=t,this.interpolate=e(t)};return{restrict:"E",replace:!0,transclude:!0,template:'<div class="fg-cscroller-wrapper"></div>',scope:{alias:"=?"},controller:["$scope","$element","$window","$timeout","$compile",function(e,t,n){var i=this,s=t.width();this.shown=[],this.children=[],this.exports={};var a=function(e){e.css("left",e.offset+"px")};this.append=function(){var n,s=i.shown[i.shown.length-1],r=s?(s.index+1)%i.children.length:0;return i.children[r].interpolate(e.$parent,function(e){i.shown.push(e),t.append(e),e.template=i.children[r],n=s?s.offset+s.template.width:0,e.offset=n,e.index=r,a(e)}),n},this.prepend=function(){var n,s=i.shown[0],r=s?(s.index-1%i.children.length+i.children.length)%i.children.length:0;return i.children[r].interpolate(e.$parent,function(e){i.shown.unshift(e),t.prepend(e),e.template=i.children[r],n=s?s.offset-e.template.width:0,e.index=r,e.offset=n,a(e)}),n},this.build=function(e){for(e=e||0;i.append()<s-e;);for(;i.prepend()>0-e;);},this.exports.transpose=function(e){i.build(e),i.shown.forEach(function(t){t.stop().animate({left:(t.offset+=e)+"px"},400,function(){i.shown=i.shown.filter(function(e){return e.offset+e.template.width<0||e.offset>s?(e.remove(),!1):!0})})})},this.exports.transposeLeft=function(t){if(t>0){for(var n=offset,s=0;t>s;s++)i.prepend();e.scroll+=offset-n}else{var a=0;t=Math.abs(t);for(var r=0;t>r;r++)a+=i.shown[r][0].offsetWidth;e.scroll-=a}},this.exports.transposeRight=function(t){if(t>0){for(var n=0,s=1;t>=s;s++)n+=i.shown[i.shown.length-s][0].offsetWidth;e.scroll-=n}else{var a=innerWidth;t=Math.abs(t);for(var r=0;t>r;r++)i.append();e.scroll+=innerWidth-a}},angular.element(n).bind("resize",function(){s=t.width(),i.build(),e.$apply()})}],link:function(e,n,i,s,a){a(e.$parent,function(e){e.each(function(){if(3!=this.nodeType){var e=$("<div/>",{"class":"fg-cscroller-element"});e.append(this),n.append(e),s.children.push(new t(e))}})}),$(function(){s.children.forEach(function(e){e.width=e.element.outerWidth(),e.element.remove()}),s.build()}),e.alias&&(e.alias=s.exports)}}}]),angular.module("fg.geekstrap").directive("fgAutocomplete",function(){return{restrict:"E",replace:!0,scope:{options:"@list",getIcon:"&?icons",callback:"&",limit:"=?"},templateUrl:"geekstrap/directives/autocomplete/autocomplete.html",link:function(e,t,n){var i=t.find("input");if(e.selected=0,e.getIcon=e.getIcon||function(){return"fa-angle-double-right"},e.label=function(e){return e},e.options.match(/^\w+$/))e.autocomplete=e.$parent[e.options];else{var s=e.options.split(" ");"from"===s[1]&&s[2]&&(e.label=function(e){return e[s[0]]},e.autocomplete=e.$parent[s[2]])}e.select=function(t){return"strict"in n&&"false"!==n.strict?e.suggestions.length?e.callback({item:e.suggestions[e.selected]}):!1:e.callback({item:t})},e.showList=function(){return i.val()&&e.isFocused},i.on("input",function(){var t=i.val();e.suggestions=e.autocomplete.filter(function(n){return 0===e.label(n).indexOf(t)}),e.limit&&e.suggestions.splice(e.limit),e.selected=0,e.$apply()}),i.on("keydown",function(t){var n=t.which||t.keyCode;9==n||40==n?(t.preventDefault(),e.selected=(e.selected+1)%e.suggestions.length,e.$apply()):38==n&&(e.selected=e.selected-1>-1?e.selected-1:e.suggestions.length-1,e.$apply())}),i.on("focusout",function(){e.selected=0,e.isFocused=!1}),i.on("focusin",function(){e.isFocused=!0}),e.itemHover=function(t){e.selected=t},e.itemClick=function(t){e.callback({item:t}),i.val("")}}}}),angular.module("fg.geekstrap").provider("Modal",function(){var e=function(e,t){this.templateUrl=t.templateUrl,this.template=t.template,this.defaults=t.defaults,this.name=e},t={},n=this;this.modal=function(i,s){return t[i]=function(t){var n=t.invoke(s);return new e(i,n)},n},this.$get=["$document","$compile","$rootScope","$http","$templateCache","$q","$animate","$injector",function(n,i,s,a,r,o,l,c){Object.keys(t).forEach(function(e){t[e]=t[e](c)});var u,d=s.$new(),f=[],p=function(e){var t=this,n={},i={when:function(e){return o.all(i[e].map(function(e){return o.when(e())})).finally(n[e].resolve,n[e].reject)},call:function(e){i[e].forEach(function(e){e()})}};"accept dismiss link overlay conceal destroy".split(" ").forEach(function(e){n[e]=o.defer(),i[e]=[]}),this.$template=e,this.$index=0,this.accept=function(){return i.when("accept").finally(t.destroy)},this.dismiss=function(){return i.when("dismiss").finally(t.destroy)},this.destroy=function(){return i.when("destroy").finally(function(){var e=f.indexOf(t);f.splice(e,1),t.element.remove(),f.forEach(function(e){e.$index>t.$index&&e.overlay()}),d.show=f.length})},this.when=function(e){return n[e].promise},this.link=function(e){t.element=e,u.append(e),t.element.css("z-index",1e4),f.forEach(function(e){e.conceal()}),f.unshift(t),d.show=!0,i.call("link")},this.overlay=function(){0!==t.$index&&(t.element.css("z-index","+=1"),t.$index--,i.call("overlay"))},this.conceal=function(){t.element.css("z-index","-=1"),t.$index++,i.call("conceal")},this.on=function(e,n){return e.split(" ").forEach(function(e){i[e].push(n.bind(t))}),t}};i(angular.element('<div class="fg-modal-wrapper ng-hide" ng-show="show"></div>'))(d,function(e){u=e,n.find("body").append(u)}),e.prototype.pop=function(e){var t=new p(this);if(e=e||{},"Object"===e.constructor.name){var n=s.$new();for(var o in e)n[o]=e[o];e=n}else e=e.$new();e.$modal=t;var l=this,c=function(n){i(n)(e,t.link)};return this.templateUrl?a({method:"GET",cache:r,url:this.templateUrl,type:"text/html"}).success(c):c(this.template),this.defaults&&Object.keys(this.defaults).forEach(function(e){t.on(e,l.defaults[e])}),t};var h=function(e){return e?t[e]:f[0]};return h.list=function(){return f.sort(function(e,t){return e.$index>t.$index})},h}]}),angular.module("fg.geekstrap").directive("fgSubmitField",function(){return{restrict:"A",replace:!0,scope:{callback:"&fgSubmitField"},link:function(e,t){t.on("keydown",function(n){if(13==n.which){n.preventDefault();var i=t.val();e.callback({value:i})&&t.val(""),e.$apply()}})}}}),angular.module("fg.geekstrap").run(["$templateCache",function(e){e.put("geekstrap/directives/autocomplete/autocomplete.html",'<fieldset class="fg-autocomplete-wrapper">\n    <input fg-submit-field="select(value)" class="form-control" />\n    <ul class="list-group" ng-show="showList()">\n        <li ng-repeat="suggestion in suggestions"\n            ng-class="{ active: $index == selected }"\n            ng-mouseenter="itemHover($index)"\n            ng-click="itemClick(suggestion)"\n            class="list-group-item">\n            <i class="fa fa-fw {{ getIcon({ item: suggestion }) }}"></i>\n            {{ label(suggestion) }}\n        </li>\n    </ul>\n</fieldset>\n'),e.put("geekstrap/directives/circular-scroller/circular-scroller.html",""),e.put("geekstrap/directives/navbar/navbar-tab.html",'<div class="fg-navbar-tab" ng-transclude ng-class="{active: active}">\n</div>\n'),e.put("geekstrap/directives/navbar/navbar.html",'<div class="fg-navbar">\n    <div ng-transclude></div>\n    <div class="fg-navbar-caret" ng-style="caretOffset"></div>\n</div>\n'),e.put("geekstrap/directives/progress-button/progress-button.html",'<button class="progress-button" ng-class="{loading: isLoading}">\n    <div class="content" ng-transclude></div>\n    <div class="progress-button-bar" ng-style="loadingBar"></div>\n</button>\n'),e.put("geekstrap/directives/sidebar/sidebar-item.html",'<div class="sidebar-item" ng-class="{active: active}">\n    <div class="sidebar-item-label" ng-transclude>\n    </div>\n    <div class="sidebar-item-icon">\n        <span class="{{icon}}"></span>\n    </div>\n</div>\n'),e.put("geekstrap/directives/sidebar/sidebar.html",'<div class="sidebar">\n    <div class="sidebar-toggle">\n        <span class="{{icon}}"></span>\n    </div>\n    <div class="sidebar-content" ng-transclude ng-style="offset"></div>\n</div>\n')}]);